<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Cryptomnio::REST::Client - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../REST.html">Cryptomnio::REST</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li class="calls-super" ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-_check_errors">#_check_errors</a>
    
    <li ><a href="#method-i-_rest_call">#_rest_call</a>
    
    <li ><a href="#method-i-auth_cryptomnio">#auth_cryptomnio</a>
    
    <li ><a href="#method-i-auth_cryptomnio_test">#auth_cryptomnio_test</a>
    
    <li ><a href="#method-i-context_switch">#context_switch</a>
    
    <li ><a href="#method-i-del_account_order">#del_account_order</a>
    
    <li ><a href="#method-i-get_account">#get_account</a>
    
    <li ><a href="#method-i-get_account_available_balance_symbol">#get_account_available_balance_symbol</a>
    
    <li ><a href="#method-i-get_account_balance">#get_account_balance</a>
    
    <li ><a href="#method-i-get_account_balance_symbol">#get_account_balance_symbol</a>
    
    <li ><a href="#method-i-get_account_order">#get_account_order</a>
    
    <li ><a href="#method-i-get_account_orders">#get_account_orders</a>
    
    <li ><a href="#method-i-get_account_trade">#get_account_trade</a>
    
    <li ><a href="#method-i-get_account_trades">#get_account_trades</a>
    
    <li ><a href="#method-i-get_market_ema">#get_market_ema</a>
    
    <li ><a href="#method-i-get_market_momentum">#get_market_momentum</a>
    
    <li ><a href="#method-i-get_market_orderbook">#get_market_orderbook</a>
    
    <li ><a href="#method-i-get_market_orderbook_depth_price">#get_market_orderbook_depth_price</a>
    
    <li ><a href="#method-i-get_market_orderbook_depth_volume">#get_market_orderbook_depth_volume</a>
    
    <li ><a href="#method-i-get_market_periods">#get_market_periods</a>
    
    <li ><a href="#method-i-get_market_ticker">#get_market_ticker</a>
    
    <li ><a href="#method-i-get_market_tickers">#get_market_tickers</a>
    
    <li ><a href="#method-i-get_market_trades">#get_market_trades</a>
    
    <li ><a href="#method-i-get_markets">#get_markets</a>
    
    <li ><a href="#method-i-get_venues">#get_venues</a>
    
    <li ><a href="#method-i-put_account_order_limit">#put_account_order_limit</a>
    
    <li ><a href="#method-i-put_account_order_market">#put_account_order_market</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Cryptomnio::REST::Client">
  <h1 id="class-Cryptomnio::REST::Client" class="class">
    class Cryptomnio::REST::Client
  </h1>

  <section class="description">
    
<p>This is the <a href="../../Cryptomnio.html">Cryptomnio</a> REST <a
href="Client.html">Client</a> object Class</p>

<p>It inherets from the <a href="../REST.html">Cryptomnio::REST</a> object
Class and contains REST Client-specific methods and variables.</p>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-config" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">config</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">() { |self| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Object initialization</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              <a href="../../Cryptomnio.html#method-c-new">Cryptomnio.new</a>
            </div>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 709</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>
        <span class="ruby-keyword">yield</span> <span class="ruby-keyword">self</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
        <span class="ruby-keyword">super</span>

        <span class="ruby-comment">##</span>
        <span class="ruby-comment"># Configuration check</span>

        <span class="ruby-comment"># Check for required API hostnames</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: api_host_core&quot;</span>    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:api_host_core</span>]
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: api_host_cma&quot;</span>     <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:api_host_cma</span>]

        <span class="ruby-comment"># Check for required Authentication Credentials</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: authtype&quot;</span>         <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:authtype</span>]
        <span class="ruby-keyword">case</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:authtype</span>]
                <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;Basic&#39;</span>
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: username&quot;</span>   <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:username</span>]
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: password&quot;</span>   <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:password</span>]
                <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;Cryptomnio&#39;</span>
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: access_key&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:access_key</span>]
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: secret_key&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:secret_key</span>]
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Unrecognized Authentication Type: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:authtype</span>]
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># Check for at least one contexts (venue+account)</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Paramters: contexts&quot;</span>         <span class="ruby-keyword">if</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>].<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>

        <span class="ruby-comment"># Check configured contexts and validate them by switching to them</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Checking all configured contexts (venue + account) for required parameters&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
        <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">label</span>, <span class="ruby-identifier">paramhash</span> <span class="ruby-operator">|</span>
                <span class="ruby-keyword">self</span>.<span class="ruby-identifier">context_switch</span>( <span class="ruby-identifier">label</span> )
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># Switch back to the first context by default</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Switching back to the first context by default&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
        <span class="ruby-identifier">label</span> = <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>].<span class="ruby-identifier">keys</span>[<span class="ruby-value">0</span>]
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">context_switch</span>( <span class="ruby-identifier">label</span> )

        <span class="ruby-comment"># Output</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Cryptomnio Startup Configuration:&quot;</span>
                <span class="ruby-identifier">p</span> <span class="ruby-ivar">@config</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-_check_errors" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_check_errors</span><span
            class="method-args">( response, thisfailure )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Error-handling method</p>
          
          

          
          <div class="method-source-code" id="_check_errors-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 758</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_check_errors</span>( <span class="ruby-identifier">response</span>, <span class="ruby-identifier">thisfailure</span> )
        <span class="ruby-keyword">case</span>
        <span class="ruby-keyword">when</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">==</span> <span class="ruby-value">400</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: [%d]: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ] 
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">when</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">==</span> <span class="ruby-value">401</span>
                <span class="ruby-keyword">case</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:authtype</span>] 
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;Basic&quot;</span>
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Cryptomnio Basic Authentication for user %s failed: [%d]: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-ivar">@config</span>[<span class="ruby-value">:username</span>], <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ]
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;Cryptomnio&quot;</span>
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Cryptomnio Key Authentication failed: [%d]: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ]
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Authentication failed: [%d]: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ]
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">when</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">==</span> <span class="ruby-value">404</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Missing Resource&quot;</span>
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">when</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">==</span> <span class="ruby-value">502</span>
                <span class="ruby-comment"># Bad Gateway</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: %s: [%d]: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">thisfailure</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ]
        <span class="ruby-keyword">when</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">==</span> <span class="ruby-value">504</span>
                <span class="ruby-comment"># Gateway Timeout (temporary error)</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Temporary Error: %s: [%d]: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">thisfailure</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ] 
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">when</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">!=</span> <span class="ruby-value">200</span>
                <span class="ruby-comment"># Catch-all: Anything other than success</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: %s: [%d]: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">thisfailure</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ] 
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">else</span>
                <span class="ruby-comment"># 200 Success!</span>
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rest_call" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rest_call</span><span
            class="method-args">( method = :get, api = :core, uripath = &quot;/&quot;, uriparameters = nil, error_string = &quot;REST API Call Failed&quot;, body = nil )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Generic REST API call method Provides RestClient call with needed
authentication headers and error handling</p>
          
          

          
          <div class="method-source-code" id="_rest_call-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_rest_call</span>( <span class="ruby-identifier">method</span> = <span class="ruby-value">:get</span>, <span class="ruby-identifier">api</span> = <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span> = <span class="ruby-string">&quot;/&quot;</span>, <span class="ruby-identifier">uriparameters</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">error_string</span> = <span class="ruby-string">&quot;REST API Call Failed&quot;</span>, <span class="ruby-identifier">body</span> = <span class="ruby-keyword">nil</span> )
        <span class="ruby-comment"># Get the HMAC SHA-512 hash signature value for the method+URIpath</span>
        <span class="ruby-identifier">signature</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auth_cryptomnio</span>( <span class="ruby-identifier">method</span>, <span class="ruby-ivar">@URI_VERSION</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uripath</span> )

        <span class="ruby-comment"># Build the URI from the URIpath and optional parameters</span>
        <span class="ruby-keyword">case</span> <span class="ruby-identifier">api</span>
                <span class="ruby-keyword">when</span> <span class="ruby-value">:core</span>
                        <span class="ruby-identifier">uri</span> = <span class="ruby-string">&quot;https://&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:api_host_core</span>] <span class="ruby-operator">+</span> <span class="ruby-ivar">@URI_VERSION</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uripath</span>
                <span class="ruby-keyword">when</span> <span class="ruby-value">:cma</span>
                        <span class="ruby-identifier">uri</span> = <span class="ruby-string">&quot;https://&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:api_host_cma</span>] <span class="ruby-operator">+</span> <span class="ruby-ivar">@URI_VERSION</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uripath</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Unknown API (%s) referenced&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">api</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">uri</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;?&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uriparameters</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uriparameters</span>

        <span class="ruby-comment">##</span>
        <span class="ruby-comment"># Build the Headers</span>

        <span class="ruby-identifier">headers</span> = {
                <span class="ruby-comment"># Authentication headers Access-Key and Sign</span>
                <span class="ruby-string">&quot;Access-Key&quot;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:access_key</span>],
                <span class="ruby-string">&quot;Sign&quot;</span>       <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">signature</span>
        }
        <span class="ruby-comment"># Add a Content-type header for application/json if there is a payload body to send</span>
        <span class="ruby-identifier">headers</span>[<span class="ruby-string">&quot;Content-type&quot;</span>] = <span class="ruby-string">&quot;application/json&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">body</span>

        <span class="ruby-comment"># Call RestClient based on the method against URI with authentication headers &quot;Access-Key&quot; and &quot;Sign&quot;</span>
        <span class="ruby-keyword">begin</span>
                <span class="ruby-constant">RestClient</span><span class="ruby-operator">::</span><span class="ruby-constant">Request</span>.<span class="ruby-identifier">execute</span>(
                        <span class="ruby-value">method:</span>  <span class="ruby-identifier">method</span>,
                        <span class="ruby-value">url:</span>     <span class="ruby-identifier">uri</span>,
                        <span class="ruby-value">headers:</span> <span class="ruby-identifier">headers</span>,
                        <span class="ruby-value">payload:</span> <span class="ruby-identifier">body</span>
                        ) <span class="ruby-keyword">do</span>
                        <span class="ruby-operator">|</span><span class="ruby-identifier">response</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">result</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span><span class="ruby-operator">|</span>

                        <span class="ruby-comment"># Debug output</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Request:      %s: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">request</span>.<span class="ruby-identifier">method</span>.<span class="ruby-identifier">upcase</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">uri</span> ]
                                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Headers:      %s&quot;</span>     <span class="ruby-operator">%</span> [ <span class="ruby-identifier">request</span>.<span class="ruby-identifier">headers</span> ]
                                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;POST payload: %s&quot;</span>     <span class="ruby-operator">%</span> [ <span class="ruby-identifier">body</span> ] <span class="ruby-keyword">if</span> <span class="ruby-identifier">body</span>
                                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Timestamp:    %s&quot;</span>     <span class="ruby-operator">%</span> [ <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&#39;%Y-%m-%d %H:%M:%S %z&#39;</span>) ]
                                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Response:     %d: %s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>, <span class="ruby-identifier">response</span> ]
                        <span class="ruby-keyword">end</span>

                        <span class="ruby-comment"># Check for errors</span>
                        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_check_errors</span>( <span class="ruby-identifier">response</span>, <span class="ruby-identifier">error_string</span> )

                        <span class="ruby-comment"># Success: Convert JSON to Ruby object and return it</span>
                        <span class="ruby-identifier">responsebody</span> = <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>)[<span class="ruby-string">&#39;body&#39;</span>]
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">responsebody</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-comment"># Rescue any exceptions thrown by _check_errors</span>

                <span class="ruby-comment"># TODO: Retry 3 times with pauses if temporary error</span>
                
                <span class="ruby-comment"># Output</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

                <span class="ruby-comment"># Pass it on</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-auth_cryptomnio" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">auth_cryptomnio</span><span
            class="method-args">( method, uripath )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="../../Cryptomnio.html">Cryptomnio</a> Key Authentication</p>
          
          

          
          <div class="method-source-code" id="auth_cryptomnio-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">auth_cryptomnio</span>( <span class="ruby-identifier">method</span>, <span class="ruby-identifier">uripath</span> )
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Building Authentication Credentials&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

        <span class="ruby-comment"># Create concatenated method and base URL path string</span>
        <span class="ruby-identifier">methodpath</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uripath</span> <span class="ruby-comment"># convert RestClient&#39;s method symbol to uppercase string</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;        Method+Path = %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">methodpath</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

        <span class="ruby-comment"># Create HMAC SHA-512 authentication hash of methodpath using secret key</span>
        <span class="ruby-ivar">@config</span>[<span class="ruby-value">:auth_string</span>] = <span class="ruby-constant">Base64</span>.<span class="ruby-identifier">encode64</span>(<span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">HMAC</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-string">&#39;sha512&#39;</span>, <span class="ruby-ivar">@config</span>[<span class="ruby-value">:secret_key</span>], <span class="ruby-identifier">methodpath</span>)).<span class="ruby-identifier">split</span>.<span class="ruby-identifier">join</span> <span class="ruby-comment"># .split.join is to remove &#39;/n&#39; inserted into signature by HMAC</span>

        <span class="ruby-comment"># Output</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$VERBOSE</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;       Access-Key: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:access_key</span>]
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;       Signature:  %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:auth_string</span>]
                <span class="ruby-identifier">puts</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># Return the signature</span>
        <span class="ruby-keyword">return</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:auth_string</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-auth_cryptomnio_test" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">auth_cryptomnio_test</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Test method wrapper for <a href="../../Cryptomnio.html">Cryptomnio</a> Key
Authentication</p>
          
          

          
          <div class="method-source-code" id="auth_cryptomnio_test-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 137</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">auth_cryptomnio_test</span>
        <span class="ruby-comment"># TODO: Find better CMA test call to use</span>
        <span class="ruby-identifier">method</span>   = <span class="ruby-value">:get</span> 
        <span class="ruby-identifier">endpoint</span> = <span class="ruby-string">&quot;/venues&quot;</span>
        <span class="ruby-comment">#endpoint = &quot;/nope&quot;</span>
        <span class="ruby-identifier">uripath</span>  = <span class="ruby-ivar">@URI_VERSION</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">endpoint</span>
        <span class="ruby-identifier">signature</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auth_cryptomnio</span>( <span class="ruby-identifier">method</span>, <span class="ruby-identifier">uripath</span> )

        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Testing Cryptomnio Key Authentication&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$VERBOSE</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;       Requesting: %s %s%s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-identifier">method</span>, <span class="ruby-ivar">@config</span>[<span class="ruby-value">:apiurl</span>], <span class="ruby-identifier">uripath</span> ]
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;       Access-Key: %s&quot;</span>      <span class="ruby-operator">%</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:access_key</span>]
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;       Signature:  %s&quot;</span>      <span class="ruby-operator">%</span> <span class="ruby-identifier">signature</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># Test Authentication Call</span>
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-identifier">method</span>, <span class="ruby-identifier">api</span> = <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span> = <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparameters</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">error_string</span> = <span class="ruby-string">&quot;Cryptomnio Key Authentication test failed.&quot;</span> )

        <span class="ruby-comment"># Success</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-context_switch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">context_switch</span><span
            class="method-args">( label )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Switch Object&#39;s Context (Account + Venue to operate as)</p>
          
          

          
          <div class="method-source-code" id="context_switch-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">context_switch</span>( <span class="ruby-identifier">label</span> )
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Switching to context \&quot;%s\&quot;&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">label</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

        <span class="ruby-comment"># Validate that a context for label exists</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;No context found for label: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">label</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>][<span class="ruby-identifier">label</span>]
        <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>][<span class="ruby-identifier">label</span>].<span class="ruby-identifier">inspect</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

        <span class="ruby-comment"># Validate that the required parameters exist</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: contexts[:venue]&quot;</span>      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>][<span class="ruby-identifier">label</span>][<span class="ruby-value">:venue</span>]
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: contexts[:accountid]&quot;</span>  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>][<span class="ruby-identifier">label</span>][<span class="ruby-value">:accountid</span>]
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Missing Configuration Parameter: contexts[:venuekeyid]&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>][<span class="ruby-identifier">label</span>][<span class="ruby-value">:venuekeyid</span>]

        <span class="ruby-comment"># Switch to the context</span>
        <span class="ruby-ivar">@context</span> = <span class="ruby-ivar">@config</span>[<span class="ruby-value">:contexts</span>][<span class="ruby-identifier">label</span>]

        <span class="ruby-comment"># Return true on success</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Context Switch Successful!&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-del_account_order" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">del_account_order</span><span
            class="method-args">( orderid:, venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete (cancel) a venue account&#39;s open order</p>
          
          

          
          <div class="method-source-code" id="del_account_order-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 389</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">del_account_order</span>(
        <span class="ruby-value">orderid:</span>,
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/exchanges/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/orders/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">orderid</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;venueKeyId=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venuekeyid</span> 
        <span class="ruby-identifier">errormsg</span>  = <span class="ruby-string">&quot;Cancellation of venue account&#39;s order %s for account %s failed.&quot;</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">orderid</span>, <span class="ruby-identifier">accountid</span>]
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:delete</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-identifier">errormsg</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account</span><span
            class="method-args">( venue: @context[:venue].to_s, accountid: @context[:accountid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a hash of a venue account</p>
          
          

          
          <div class="method-source-code" id="get_account-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account</span>(
        <span class="ruby-value">venue:</span>     <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>] )

        <span class="ruby-identifier">uripath</span>  = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span>
        <span class="ruby-identifier">errormsg</span> = <span class="ruby-string">&quot;Retrieval of venue account information for account %s failed.&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">accountid</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">errormsg</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account_available_balance_symbol" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account_available_balance_symbol</span><span
            class="method-args">( symbol:, venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get account balance for symbol</p>
          
          

          
          <div class="method-source-code" id="get_account_available_balance_symbol-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 289</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account_available_balance_symbol</span>(
        <span class="ruby-value">symbol:</span>,
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">symbol</span> = <span class="ruby-identifier">symbol</span>.<span class="ruby-identifier">downcase</span>
        <span class="ruby-identifier">$balance</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-comment"># TODO: Check cached balance&#39;s timestamp, if too old, update balances</span>
        <span class="ruby-comment"># Retrieve all balances for account</span>
        <span class="ruby-ivar">@balances</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_account_balance</span>( <span class="ruby-value">venue:</span> <span class="ruby-identifier">venue</span>, <span class="ruby-value">accountid:</span> <span class="ruby-identifier">accountid</span>, <span class="ruby-value">venuekeyid:</span> <span class="ruby-identifier">venuekeyid</span> )
        <span class="ruby-comment"># Find the balance for the symbol we want</span>
        <span class="ruby-ivar">@balances</span>[<span class="ruby-string">&quot;assets&quot;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">asset</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">$balance</span> = <span class="ruby-identifier">asset</span>[<span class="ruby-string">&quot;available&quot;</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">asset</span>[<span class="ruby-string">&quot;currency&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">symbol</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-comment"># Raise an exception if the requested symbol is not found</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;No balance returned for currency symbol \&quot;%s\&quot;&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">symbol</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">$balance</span>
        <span class="ruby-comment"># Return balance for requested symbol as a floating-point integer</span>
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">$balance</span>.<span class="ruby-identifier">to_f</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account_balance" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account_balance</span><span
            class="method-args">( venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of hashes of a venue account&#39;s balances</p>
          
          

          
          <div class="method-source-code" id="get_account_balance-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account_balance</span>(
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/exchanges/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/balance&quot;</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;venueKeyId=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venuekeyid</span> 
        <span class="ruby-identifier">errormsg</span>  = <span class="ruby-string">&quot;Retrieval of venue account&#39;s balance for account %s failed.&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">accountid</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-identifier">errormsg</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account_balance_symbol" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account_balance_symbol</span><span
            class="method-args">( symbol:, venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get account balance for symbol</p>
          
          

          
          <div class="method-source-code" id="get_account_balance_symbol-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 267</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account_balance_symbol</span>(
        <span class="ruby-value">symbol:</span>,
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">symbol</span> = <span class="ruby-identifier">symbol</span>.<span class="ruby-identifier">downcase</span>
        <span class="ruby-identifier">$balance</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-comment"># TODO: Check cached balance&#39;s timestamp, if too old, update balances</span>
        <span class="ruby-comment"># Retrieve all balances for account</span>
        <span class="ruby-ivar">@balances</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_account_balance</span>( <span class="ruby-value">venue:</span> <span class="ruby-identifier">venue</span>, <span class="ruby-value">accountid:</span> <span class="ruby-identifier">accountid</span>, <span class="ruby-value">venuekeyid:</span> <span class="ruby-identifier">venuekeyid</span> )
        <span class="ruby-comment"># Find the balance for the symbol we want</span>
        <span class="ruby-ivar">@balances</span>[<span class="ruby-string">&quot;assets&quot;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">asset</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">$balance</span> = <span class="ruby-identifier">asset</span>[<span class="ruby-string">&quot;amount&quot;</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">asset</span>[<span class="ruby-string">&quot;currency&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">symbol</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-comment"># Raise an exception if the requested symbol is not found</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;No balance returned for currency symbol \&quot;%s\&quot;&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">symbol</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">$balance</span>
        <span class="ruby-comment"># Return balance for requested symbol as a floating-point integer</span>
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">$balance</span>.<span class="ruby-identifier">to_f</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account_order" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account_order</span><span
            class="method-args">( orderid:, venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an hash of a venue account&#39;s single order</p>
          
          

          
          <div class="method-source-code" id="get_account_order-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 328</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account_order</span>(
        <span class="ruby-value">orderid:</span>,
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/exchanges/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/orders/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">orderid</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;venueKeyId=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venuekeyid</span> 
        <span class="ruby-identifier">errormsg</span>  = <span class="ruby-string">&quot;Retrieval of venue account&#39;s order %s for account %s failed.&quot;</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">orderid</span>, <span class="ruby-identifier">accountid</span>]
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-identifier">errormsg</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account_orders" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account_orders</span><span
            class="method-args">( status_filters: [], venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of hashes of a venue account&#39;s orders Accepts optional
array of orders statuses for filtering results</p>
          
          

          
          <div class="method-source-code" id="get_account_orders-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 312</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account_orders</span>(
        <span class="ruby-value">status_filters:</span> [],
        <span class="ruby-value">venue:</span>          <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span>     <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/exchanges/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/orders&quot;</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;venueKeyId=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venuekeyid</span> 
        <span class="ruby-identifier">status_filters</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">status</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;status=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">status</span>.<span class="ruby-identifier">to_s</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">errormsg</span>  = <span class="ruby-string">&quot;Retrieval of venue account&#39;s orders for account %s failed.&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">accountid</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-identifier">errormsg</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account_trade" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account_trade</span><span
            class="method-args">( tradeid:, venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a hash of a venue account&#39;s trade</p>
          
          

          
          <div class="method-source-code" id="get_account_trade-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 414</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account_trade</span>(
        <span class="ruby-value">tradeid:</span>,
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/exchanges/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/trades/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">tradeid</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;venueKeyId=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venuekeyid</span> 
        <span class="ruby-identifier">errormsg</span>  = <span class="ruby-string">&quot;Retrieval of venue account&#39;s trade %s for account %s failed.&quot;</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">tradeid</span>, <span class="ruby-identifier">accountid</span>]
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-identifier">errormsg</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_account_trades" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_account_trades</span><span
            class="method-args">( venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of hashes of a venue account&#39;s trades</p>
          
          

          
          <div class="method-source-code" id="get_account_trades-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 402</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_account_trades</span>(
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/exchanges/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/trades&quot;</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;venueKeyId=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venuekeyid</span> 
        <span class="ruby-identifier">errormsg</span>  = <span class="ruby-string">&quot;Retrieval of venue account&#39;s orders for account %s failed.&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">accountid</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-identifier">errormsg</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_ema" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_ema</span><span
            class="method-args">( market:, type:, periodlength:, periodcalc:, periodcount: nil, to: nil, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an exponential moving average value for a defined period of time</p>
          
          

          
          <div class="method-source-code" id="get_market_ema-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 660</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_ema</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">type:</span>,
        <span class="ruby-value">periodlength:</span>,
        <span class="ruby-value">periodcalc:</span>,
        <span class="ruby-value">periodcount:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-comment"># periodCount defaults to 10 within Cryptomnio</span>
        <span class="ruby-value">to:</span>          <span class="ruby-keyword">nil</span>, <span class="ruby-comment"># to defaults to Time.now within Cryptomnio</span>
        <span class="ruby-value">venue:</span>       <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-identifier">uripath</span>    = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/averages/ema&quot;</span>
        <span class="ruby-identifier">uriparams</span>  = <span class="ruby-string">&quot;type=%s&quot;</span>          <span class="ruby-operator">%</span> <span class="ruby-identifier">type</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;periodLength=%s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">periodlength</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;periodCalc=%d&quot;</span>   <span class="ruby-operator">%</span> <span class="ruby-identifier">periodcalc</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;periodCount=%d&quot;</span>  <span class="ruby-operator">%</span> <span class="ruby-identifier">periodcount</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">periodcount</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;to=%d&quot;</span>           <span class="ruby-operator">%</span> <span class="ruby-identifier">to</span>            <span class="ruby-keyword">if</span> <span class="ruby-identifier">to</span>

        <span class="ruby-identifier">retries</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">begin</span>
                <span class="ruby-identifier">result</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-string">&quot;Retrieval of venue&#39;s market&#39;s market Exponential Moving Average (EMA) failed.&quot;</span> )
                
                <span class="ruby-comment"># Raise an execption if the result is null or empty</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Empty set of market Exponential Moving Average (EMA) received&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>
                
                <span class="ruby-comment"># Output</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;EMA sets:\n&quot;</span>
                        <span class="ruby-identifier">pp</span> <span class="ruby-identifier">result</span>
                <span class="ruby-keyword">end</span>

                <span class="ruby-comment"># Return averages array</span>
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-keyword">case</span>
                        <span class="ruby-keyword">when</span> <span class="ruby-identifier">retries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>
                                <span class="ruby-identifier">retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
                                <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
                                <span class="ruby-keyword">retry</span>
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Received empty set of market Exponential Moving Average (EMA) for 3 retries: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
                                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>  
        <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_momentum" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_momentum</span><span
            class="method-args">( market:, type:, periodlength:, periodcount: nil, to: nil, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a momentum value for a defined period of time</p>
          
          

          
          <div class="method-source-code" id="get_market_momentum-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 620</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_momentum</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">type:</span>,
        <span class="ruby-value">periodlength:</span>,
        <span class="ruby-value">periodcount:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-comment"># periodCount defaults to 10 within Cryptomnio</span>
        <span class="ruby-value">to:</span>          <span class="ruby-keyword">nil</span>, <span class="ruby-comment"># to defaults to Time.now within Cryptomnio</span>
        <span class="ruby-value">venue:</span>       <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-identifier">uripath</span>    = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/momentum&quot;</span>
        <span class="ruby-identifier">uriparams</span>  = <span class="ruby-string">&quot;type=%s&quot;</span>          <span class="ruby-operator">%</span> <span class="ruby-identifier">type</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;periodLength=%s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">periodlength</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;periodCount=%d&quot;</span>  <span class="ruby-operator">%</span> <span class="ruby-identifier">periodcount</span>  <span class="ruby-keyword">if</span> <span class="ruby-identifier">periodcount</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;to=%d&quot;</span>           <span class="ruby-operator">%</span> <span class="ruby-identifier">to</span>           <span class="ruby-keyword">if</span> <span class="ruby-identifier">to</span>

        <span class="ruby-identifier">retries</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">begin</span>
                <span class="ruby-identifier">result</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-string">&quot;Retrieval of venue&#39;s market&#39;s market momentum failed.&quot;</span> )
                
                <span class="ruby-comment"># Raise an execption if the result is null or empty</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Empty set of market momentum received&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>
                
                <span class="ruby-comment"># Output</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Momentum: %f\n&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;price_change&#39;</span>].<span class="ruby-identifier">to_f</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

                <span class="ruby-comment"># Return momentum value</span>
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;price_change&#39;</span>].<span class="ruby-identifier">to_f</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-keyword">case</span>
                        <span class="ruby-keyword">when</span> <span class="ruby-identifier">retries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>
                                <span class="ruby-identifier">retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
                                <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
                                <span class="ruby-keyword">retry</span>
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Received empty set of market momentum for 3 retries: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
                                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>  
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_orderbook" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_orderbook</span><span
            class="method-args">( market:, side: nil, limit: nil, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a hash of a venue market&#39;s order book</p>
          
          

          
          <div class="method-source-code" id="get_market_orderbook-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 430</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_orderbook</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">side:</span>  <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">limit:</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">venue:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/orderbook&quot;</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;&quot;</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;side=%s&quot;</span>  <span class="ruby-operator">%</span> <span class="ruby-identifier">side</span>  <span class="ruby-keyword">if</span> <span class="ruby-identifier">side</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;limit=%d&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">limit</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">limit</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uriparams</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>

        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-string">&quot;Retrieval of venue market&#39;s order book failed.&quot;</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_orderbook_depth_price" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_orderbook_depth_price</span><span
            class="method-args">( market:, side: nil, volume: nil, cumulative: nil, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a hash of a venue market&#39;s order book&#39;s price at a specified
volume</p>
          
          

          
          <div class="method-source-code" id="get_market_orderbook_depth_price-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 446</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_orderbook_depth_price</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">side:</span>       <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">volume:</span>     <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">cumulative:</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">venue:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/orderbook/depth/price&quot;</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;&quot;</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;side=%s&quot;</span>  <span class="ruby-operator">%</span> <span class="ruby-identifier">side</span>  <span class="ruby-keyword">if</span> <span class="ruby-identifier">side</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;volume=%f&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">volume</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">volume</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;cumulative=%s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">cumulative</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">cumulative</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uriparams</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>

        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-node">&quot;Retrieval of venue market&#39;s order book price at given volume (#{volume}) failed.&quot;</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_orderbook_depth_volume" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_orderbook_depth_volume</span><span
            class="method-args">( market:, side: nil, price: nil, cumulative: nil, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a hash of a venue market&#39;s order book&#39;s volume at a
specified price</p>
          
          

          
          <div class="method-source-code" id="get_market_orderbook_depth_volume-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 464</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_orderbook_depth_volume</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">side:</span>       <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">price:</span>      <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">cumulative:</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">venue:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/orderbook/depth/volume&quot;</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;&quot;</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;side=%s&quot;</span>  <span class="ruby-operator">%</span> <span class="ruby-identifier">side</span>  <span class="ruby-keyword">if</span> <span class="ruby-identifier">side</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;price=%f&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">price</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">price</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;cumulative=%s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">cumulative</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">cumulative</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uriparams</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>

        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-node">&quot;Retrieval of venue market&#39;s order book volume at given price (#{price}) failed.&quot;</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_periods" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_periods</span><span
            class="method-args">( market:, periodlength:, periodcount: nil, to: nil, limit: nil, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of period data</p>
          
          

          
          <div class="method-source-code" id="get_market_periods-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 575</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_periods</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">periodlength:</span>,
        <span class="ruby-value">periodcount:</span>   <span class="ruby-keyword">nil</span>, <span class="ruby-comment"># periodCount defaults to 10 within Cryptomnio</span>
        <span class="ruby-value">to:</span>            <span class="ruby-keyword">nil</span>, <span class="ruby-comment"># to defaults to Time.now within Cryptomnio</span>
        <span class="ruby-value">limit:</span>         <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">venue:</span>         <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-identifier">uripath</span>    = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/periods&quot;</span>
        <span class="ruby-identifier">uriparams</span>  = <span class="ruby-string">&quot;periodLength=%s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">periodlength</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;periodCount=%d&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">periodcount</span>  <span class="ruby-keyword">if</span> <span class="ruby-identifier">periodcount</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;to=%d&quot;</span>          <span class="ruby-operator">%</span> <span class="ruby-identifier">to</span>           <span class="ruby-keyword">if</span> <span class="ruby-identifier">to</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;limit=%d&quot;</span>       <span class="ruby-operator">%</span> <span class="ruby-identifier">limit</span>        <span class="ruby-keyword">if</span> <span class="ruby-identifier">limit</span>

        <span class="ruby-comment"># TODO: Determine if we have any of the requested periods cached, and instead request only what we don&#39;t already have</span>

        <span class="ruby-identifier">retries</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">begin</span>
                <span class="ruby-identifier">result</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-string">&quot;Retrieval of venue&#39;s market&#39;s market periods failed.&quot;</span> )
                
                <span class="ruby-comment"># Raise an execption if the result is null or empty</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Empty set of market periods received&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>
                
                <span class="ruby-comment"># Output</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Periods:\n&quot;</span>
                        <span class="ruby-identifier">pp</span> <span class="ruby-identifier">result</span>
                <span class="ruby-keyword">end</span>

                <span class="ruby-comment"># Return the periods array</span>
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-keyword">case</span>
                        <span class="ruby-keyword">when</span> <span class="ruby-identifier">retries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>
                                <span class="ruby-identifier">retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
                                <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
                                <span class="ruby-keyword">retry</span>
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Received empty set of market periods for 3 retries: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
                                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>  
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_ticker" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_ticker</span><span
            class="method-args">( market:, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a venue market&#39;s most current ticker hash</p>
          
          

          
          <div class="method-source-code" id="get_market_ticker-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 517</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_ticker</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">venue:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-comment"># Call get_market_tickers to request most recent ticker</span>
        <span class="ruby-comment">#TODO: Replace with this call once Cryptomnio accepts calls without a from parameter (don&#39;t need a set of tickers, just most recent)</span>
        <span class="ruby-comment">#tickers = self.get_market_tickers( market: market, venue: venue )</span>
        <span class="ruby-identifier">tickers</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_market_tickers</span>( <span class="ruby-value">market:</span> <span class="ruby-identifier">market</span>, <span class="ruby-value">from:</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">30</span>) <span class="ruby-operator">*</span> <span class="ruby-value">1000</span>, <span class="ruby-value">venue:</span> <span class="ruby-identifier">venue</span> ) 

        <span class="ruby-comment"># Check timestamp on ticker and ensure it&#39;s not too old</span>
        <span class="ruby-identifier">too_old</span> = (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">120</span>) <span class="ruby-operator">*</span> <span class="ruby-value">1000</span> <span class="ruby-comment"># over 2 minutes ago</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;ERROR: Most recent ticker is too old! (%s is over 2 minutes ago)&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">tickers</span>[<span class="ruby-string">&#39;latest&#39;</span>][<span class="ruby-string">&#39;timestamp&#39;</span>] <span class="ruby-operator">/</span> <span class="ruby-value">1000</span>) ] <span class="ruby-keyword">if</span> <span class="ruby-identifier">tickers</span>[<span class="ruby-string">&#39;latest&#39;</span>][<span class="ruby-string">&#39;timestamp&#39;</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">too_old</span>

        <span class="ruby-comment"># Output</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Ticker: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">tickers</span>[<span class="ruby-string">&#39;latest&#39;</span>][<span class="ruby-string">&#39;price&#39;</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">$VERBOSE</span>

        <span class="ruby-keyword">return</span> <span class="ruby-identifier">tickers</span>[<span class="ruby-string">&#39;latest&#39;</span>].<span class="ruby-identifier">dup</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_tickers" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_tickers</span><span
            class="method-args">( market:, from: (Time.now.to_i - 300) * 1000, to: nil, cursor: nil, venue: @context[:venue].to_s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of a venue market&#39;s ticker hashes</p>
          
          

          
          <div class="method-source-code" id="get_market_tickers-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 482</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_tickers</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">from:</span>   (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">300</span>) <span class="ruby-operator">*</span> <span class="ruby-value">1000</span>, <span class="ruby-comment"># default to last 5 minutes</span>
        <span class="ruby-value">to:</span>     <span class="ruby-keyword">nil</span>, <span class="ruby-comment"># to defaults to Time.now within Cryptomnio</span>
        <span class="ruby-value">cursor:</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">venue:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>)

        <span class="ruby-identifier">uripath</span>    = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/ticker&quot;</span>
        <span class="ruby-identifier">uriparams</span>  = <span class="ruby-string">&quot;from=%d&quot;</span>    <span class="ruby-operator">%</span> <span class="ruby-identifier">from</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">from</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;to=%d&quot;</span>     <span class="ruby-operator">%</span> <span class="ruby-identifier">to</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">to</span>
        <span class="ruby-identifier">uriparams</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&amp;cursor=%d&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">cursor</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cursor</span>

        <span class="ruby-identifier">retries</span> = <span class="ruby-value">0</span>
        <span class="ruby-identifier">pause</span> = <span class="ruby-value">4</span>
        <span class="ruby-keyword">begin</span>
                <span class="ruby-identifier">result</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-string">&quot;Retrieval of venue&#39;s market&#39;s market ticker failed.&quot;</span> )
                <span class="ruby-identifier">pp</span> <span class="ruby-identifier">result</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Empty response received&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: No latest ticker value&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;latest&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">dup</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-keyword">case</span>
                        <span class="ruby-keyword">when</span> <span class="ruby-identifier">retries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>
                                <span class="ruby-identifier">retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
                                <span class="ruby-identifier">sleep</span> <span class="ruby-identifier">pause</span>
                                <span class="ruby-identifier">pause</span> = <span class="ruby-identifier">pause</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>
                                <span class="ruby-keyword">retry</span>
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Continued error for 3 retries: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
                                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>  
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_market_trades" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_market_trades</span><span
            class="method-args">( market:, limit: nil, venue: @context[:venue].to_s )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a venue market&#39;s recent trades array</p>
          
          

          
          <div class="method-source-code" id="get_market_trades-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 537</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_market_trades</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">limit:</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">venue:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span> )

        <span class="ruby-identifier">uripath</span>   = <span class="ruby-string">&quot;/venues/&quot;</span>  <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">market</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/trades&quot;</span>
        <span class="ruby-identifier">uriparams</span> = <span class="ruby-string">&quot;&amp;limit=%s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">limit</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">limit</span>

        <span class="ruby-identifier">retries</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">begin</span>
                <span class="ruby-identifier">result</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:cma</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-identifier">uriparams</span>, <span class="ruby-string">&quot;Retrieval of venue&#39;s market&#39;s market ticker failed.&quot;</span> )

                <span class="ruby-comment"># Raise an execption if the result is null or empty</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Empty set of market trades received&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>

                <span class="ruby-comment"># Output</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Trades:\n&quot;</span>
                        <span class="ruby-identifier">pp</span> <span class="ruby-identifier">result</span>
                <span class="ruby-keyword">end</span>

                <span class="ruby-comment"># Return the trades array</span>
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-keyword">case</span>
                        <span class="ruby-keyword">when</span> <span class="ruby-identifier">retries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>
                                <span class="ruby-identifier">retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
                                <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
                                <span class="ruby-keyword">retry</span>
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Error: Received empty set of market trades for 3 retries: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
                                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>  
        <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_markets" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_markets</span><span
            class="method-args">( venue: )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of hashes of a venue&#39;s markets</p>
          
          

          
          <div class="method-source-code" id="get_markets-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 236</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_markets</span>( <span class="ruby-value">venue:</span> )
        <span class="ruby-identifier">uripath</span> = <span class="ruby-string">&quot;/venues/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/markets&quot;</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-string">&quot;Retrieval of supported venue&#39;s markets failed.&quot;</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_venues" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_venues</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of supported Venues</p>
          
          

          
          <div class="method-source-code" id="get_venues-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_venues</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:get</span>, <span class="ruby-value">:core</span>, <span class="ruby-string">&quot;/venues&quot;</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-string">&quot;Retrieval of supported venues failed.&quot;</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-put_account_order_limit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">put_account_order_limit</span><span
            class="method-args">( market:, side:, quantity:, price:, venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a new limit order under a venue account</p>
          
          

          
          <div class="method-source-code" id="put_account_order_limit-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">put_account_order_limit</span>( 
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">side:</span>,
        <span class="ruby-value">quantity:</span>,
        <span class="ruby-value">price:</span>,
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>  = <span class="ruby-string">&quot;/venues/exchanges/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/accounts/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/orders&quot;</span>
        <span class="ruby-identifier">errormsg</span> = <span class="ruby-string">&quot;Creation of new limit order for account %s failed.&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">accountid</span>
        <span class="ruby-identifier">body</span>     = {
                <span class="ruby-string">&quot;venue&quot;</span>      <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">venue</span>,
                <span class="ruby-string">&quot;venueKeyId&quot;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">venuekeyid</span>,
                <span class="ruby-string">&quot;orderType&quot;</span>  <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;limit&quot;</span>,
                <span class="ruby-string">&quot;side&quot;</span>       <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">side</span>,
                <span class="ruby-string">&quot;quantity&quot;</span>   <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">quantity</span>,
                <span class="ruby-string">&quot;price&quot;</span>      <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">price</span>,
                <span class="ruby-string">&quot;market&quot;</span>     <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">market</span>
        }
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:post</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">errormsg</span>, <span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_json</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-put_account_order_market" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">put_account_order_market</span><span
            class="method-args">( market:, side:, quantity:, amount:, venue: @context[:venue].to_s, accountid: @context[:accountid], venuekeyid: @context[:venuekeyid] )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a new market order under a venue account</p>
          
          

          
          <div class="method-source-code" id="put_account_order_market-source">
            <pre><span class="ruby-comment"># File lib/cryptomnio.rb, line 341</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">put_account_order_market</span>(
        <span class="ruby-value">market:</span>,
        <span class="ruby-value">side:</span>,
        <span class="ruby-value">quantity:</span>,
        <span class="ruby-value">amount:</span>,
        <span class="ruby-value">venue:</span>      <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venue</span>].<span class="ruby-identifier">to_s</span>,
        <span class="ruby-value">accountid:</span>  <span class="ruby-ivar">@context</span>[<span class="ruby-value">:accountid</span>],
        <span class="ruby-value">venuekeyid:</span> <span class="ruby-ivar">@context</span>[<span class="ruby-value">:venuekeyid</span>] )

        <span class="ruby-identifier">uripath</span>  = <span class="ruby-string">&#39;/venues/exchanges/&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">venue</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/accounts/&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">accountid</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/orders&#39;</span>
        <span class="ruby-identifier">errormsg</span> = <span class="ruby-string">&#39;Creation of new market order for account %s failed.&#39;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">accountid</span>
        <span class="ruby-identifier">body</span>     = {
                <span class="ruby-string">&#39;venue&#39;</span>      <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">venue</span>,
                <span class="ruby-string">&#39;venueKeyId&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">venuekeyid</span>,
                <span class="ruby-string">&#39;orderType&#39;</span>  <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;market&#39;</span>,
                <span class="ruby-string">&#39;side&#39;</span>       <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">side</span>,
                <span class="ruby-string">&#39;market&#39;</span>     <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">market</span>
        }
        <span class="ruby-identifier">body</span>[<span class="ruby-string">&#39;quantity&#39;</span>] = <span class="ruby-identifier">quantity</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">quantity</span>
        <span class="ruby-identifier">body</span>[<span class="ruby-string">&#39;amount&#39;</span>]   = <span class="ruby-identifier">amount</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">amount</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_rest_call</span>( <span class="ruby-value">:post</span>, <span class="ruby-value">:core</span>, <span class="ruby-identifier">uripath</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">errormsg</span>, <span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_json</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.0.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

